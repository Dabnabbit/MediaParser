---
phase: 05-duplicate-detection---exact
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - app/static/css/duplicates.css
  - app/templates/index.html
autonomous: true

must_haves:
  truths:
    - "Duplicate groups display as expandable cards"
    - "Files within group shown side-by-side with thumbnails"
    - "Quality metrics visible for each file (resolution, size)"
    - "Radio buttons allow single file selection per group"
    - "Recommended file is highlighted visually"
  artifacts:
    - path: "app/static/css/duplicates.css"
      provides: "Styles for duplicate comparison cards"
      min_lines: 100
    - path: "app/templates/index.html"
      provides: "HTML structure for duplicate comparison view"
      contains: "duplicate-groups-container"
  key_links:
    - from: "app/templates/index.html"
      to: "app/static/css/duplicates.css"
      via: "stylesheet link"
      pattern: "duplicates.css"
---

<objective>
Create the HTML structure and CSS styles for displaying duplicate groups as comparison cards with side-by-side file layout, quality metrics, and radio button selection.

Purpose: Provide visual UI for users to compare duplicate files and select which to keep
Output: Styled HTML components ready for JavaScript integration
</objective>

<execution_context>
@/home/dab/.claude/get-shit-done/workflows/execute-plan.md
@/home/dab/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/05-duplicate-detection---exact/05-RESEARCH.md

@app/templates/index.html
@app/static/css/main.css
@app/static/css/examination.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create duplicates CSS stylesheet</name>
  <files>app/static/css/duplicates.css</files>
  <action>
Create app/static/css/duplicates.css with styles for duplicate comparison cards:

1. Container styles:
   - .duplicate-groups-container: flex column, gap between groups
   - .duplicate-group-card: card with border, rounded corners, shadow, uses CSS vars for theming

2. Group header:
   - .group-header: flex row with group info and actions
   - .group-info: file count, total size display
   - .recommended-badge: green accent background, indicates best file
   - .group-status: shows resolved/unresolved state

3. Files comparison grid:
   - .files-comparison: CSS grid, auto-fit columns (min 200px, max 300px)
   - .file-option: individual file card within group
   - .file-option.recommended: subtle highlight border (green)
   - .file-option.selected: selection highlight (accent color)

4. Quality metrics:
   - .quality-metrics: stacked list of metric rows
   - .metric: flex row with label and value
   - .metric .label: subdued color, fixed width
   - .metric .value: bold, primary text
   - .resolution-badge: special styling for megapixel display

5. Selection controls:
   - .keep-selection: radio button with custom styling
   - .keep-label: clickable label wrapping radio + text
   - .status-badge.keep: green badge for "KEEP" state
   - .status-badge.discard: red badge for "DISCARD" state

6. Group actions:
   - .group-actions: flex row at bottom of card
   - .btn-confirm-group: primary action button
   - .btn-keep-all: secondary/outline button

7. Responsive breakpoints:
   - Below 768px: single column layout for files
   - Above 768px: 2-3 column grid

Use CSS variables from main.css: --bg-primary, --bg-secondary, --border-color, --text-primary, --text-secondary, --accent-color
Support dark mode via [data-theme="dark"] selectors.
  </action>
  <verify>
test -f /home/dab/Projects/MediaParser/app/static/css/duplicates.css && wc -l /home/dab/Projects/MediaParser/app/static/css/duplicates.css
  </verify>
  <done>
duplicates.css exists with 100+ lines covering all card components, responsive design, and dark mode support
  </done>
</task>

<task type="auto">
  <name>Task 2: Add duplicate groups HTML structure to index.html</name>
  <files>app/templates/index.html</files>
  <action>
Modify app/templates/index.html:

1. Add stylesheet link in head (after examination.css):
   `<link rel="stylesheet" href="{{ url_for('static', filename='css/duplicates.css') }}">`

2. Add duplicate groups container inside #results-container, BEFORE #unified-grid:
```html
<!-- Duplicate Groups Comparison View -->
<div id="duplicate-groups-container" class="duplicate-groups-container" style="display: none;">
  <div class="duplicates-header">
    <h3>Duplicate Groups</h3>
    <div class="duplicates-summary">
      <span id="duplicates-group-count">0 groups</span>
      <span id="duplicates-file-count">0 files</span>
      <span id="duplicates-resolved-count">0 resolved</span>
    </div>
    <div class="duplicates-actions">
      <button id="btn-resolve-all" class="btn btn-primary" disabled>
        Confirm All Selections
      </button>
    </div>
  </div>
  <div id="duplicate-groups-list">
    <!-- Groups rendered by JavaScript -->
  </div>
</div>
```

3. Add confirmation modal (after examination-dialog):
```html
<!-- Duplicate Resolution Confirmation Modal -->
<dialog id="duplicate-confirm-modal" class="modal">
  <div class="modal-content">
    <h2>Confirm Duplicate Resolution</h2>
    <div class="confirmation-summary">
      <p>You are about to resolve <strong id="confirm-group-count">0</strong> duplicate groups:</p>
      <ul class="confirmation-stats">
        <li><span class="keep-icon">+</span> Keep <strong id="confirm-keep-count">0</strong> files</li>
        <li><span class="discard-icon">-</span> Discard <strong id="confirm-discard-count">0</strong> files</li>
      </ul>
      <p class="confirmation-warning">
        Discarded files will be excluded from output generation but originals remain in storage.
      </p>
    </div>
    <div class="modal-actions">
      <button id="confirm-cancel" class="btn btn-secondary">Cancel</button>
      <button id="confirm-execute" class="btn btn-danger">Confirm Discards</button>
    </div>
  </div>
</dialog>
```

4. Add script tag placeholder for duplicates.js (will be created in Plan 03):
   `<script src="{{ url_for('static', filename='js/duplicates.js') }}" defer></script>`
   (Add after selection.js script tag)

Keep all existing HTML intact. The container starts hidden and will be shown when "Duplicates" mode is selected.
  </action>
  <verify>
grep -c "duplicate-groups-container" /home/dab/Projects/MediaParser/app/templates/index.html && grep -c "duplicate-confirm-modal" /home/dab/Projects/MediaParser/app/templates/index.html
  </verify>
  <done>
index.html contains duplicate groups container, confirmation modal, and stylesheet/script references
  </done>
</task>

<task type="auto">
  <name>Task 3: Add modal styles to duplicates.css</name>
  <files>app/static/css/duplicates.css</files>
  <action>
Append modal-specific styles to app/static/css/duplicates.css:

1. Modal overlay and content (similar to examination.css):
   - #duplicate-confirm-modal: centered, max-width 500px
   - .modal-content: padding, background, border-radius

2. Confirmation summary:
   - .confirmation-summary: padding, background secondary
   - .confirmation-stats: list with icons
   - .keep-icon: green color
   - .discard-icon: red color
   - .confirmation-warning: yellow/warning background

3. Modal actions:
   - .modal-actions: flex row, justify-end, gap
   - .btn-danger: red background for destructive action

4. Dark mode support for modal elements
  </action>
  <verify>
grep -c "duplicate-confirm-modal" /home/dab/Projects/MediaParser/app/static/css/duplicates.css
  </verify>
  <done>
duplicates.css includes modal styling for confirmation dialog
  </done>
</task>

</tasks>

<verification>
1. CSS file exists and validates (no syntax errors)
2. index.html loads without errors in browser
3. Duplicate groups container present but hidden by default
4. Confirmation modal present in DOM
5. Dark mode styles apply correctly when theme="dark"
</verification>

<success_criteria>
- Duplicate comparison cards have professional styling matching app theme
- Radio buttons clearly indicate single-choice selection
- Recommended file visually distinguished (green highlight)
- Quality metrics readable and well-organized
- Responsive layout works on desktop and tablet
- Dark mode fully supported
</success_criteria>

<output>
After completion, create `.planning/phases/05-duplicate-detection---exact/05-02-SUMMARY.md`
</output>
